version: "3.8"
services:
  frontend:
#    image: frontend
    container_name: frontend
    build:
      context: src/main/react-client/
      dockerfile: Dockerfile
    ports:
      - 80:80
    depends_on:
      - backend
    networks:
      - frontend

  backend:
    #    image: backend
    container_name: backend
    build:
      context: ../react-spring-jwt
      dockerfile: Dockerfile
    ports:
      - 8080:8080
    #    depends_on:
    #      - mongo
    networks: # Networks to join (Services on the same network can communicate with each other using their name)
      - backend
      - frontend
  mongo:
    image: mongo
    container_name: mongodb
    hostname: mongo
    restart: unless-stopped
    ports:
      - 27017:27017
    volumes:
      #        - data:/data
      - ./db-data:/var/lib/mongo/data
    environment:
      - MONGO_INITDB_ROOT_USERNAME=rootuser
      - MONGO_INITDB_ROOT_PASSWORD=rootpass
    networks:
      - backend

volumes:
    data:

  # Networks to be created to facilitate communication between containers
networks:
  backend:
  frontend:
#
#    volumes:
#      data: []
#    networks:
#      default:
#        name: mongodb_network

#    mongo-express:
#      image: mongo-express
#      container_name: mongo-express
#      restart: always
#      ports:
#        - 8081:8081
#      environment:
#        - ME_CONFIG_MONGODB_ADMINUSERNAME=rootuser
#        - ME_CONFIG_MONGODB_ADMINPASSWORD=rootpass
#        - ME_CONFIG_MONGODB_SERVER=mongodb




#services:
#  mongodb:
#    image: mongo
#    container_name: mongodb
#    ports:
#      - 27017:27017
#    volumes:
#      - data:/data
#    environment:
#      - MONGO_INITDB_ROOT_USERNAME=rootuser
#      - MONGO_INITDB_ROOT_PASSWORD=rootpass
#  mongo-express:
#    image: mongo-express
#    container_name: mongo-express
#    restart: always
#    ports:
#      - 8081:8081
#    environment:
#      - ME_CONFIG_MONGODB_ADMINUSERNAME=rootuser
#      - ME_CONFIG_MONGODB_ADMINPASSWORD=rootpass
#      - ME_CONFIG_MONGODB_SERVER=mongodb
#volumes:
#  data: {}
#
#networks:
#  default:
#    name: mongodb_network